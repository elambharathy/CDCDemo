<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAP CDC CIAM Tester (Embedded)</title>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  
  <script type="text/javascript" lang="javascript" src="cdcsite.js"></script>
  <link rel="stylesheet" href="cdcsite.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>

  <header class="header">
    <div class="header-content">
      <img
        src="https://www.sap.com/design-system/digital/foundations/identity/logo/media_1ee0ca2bfe9b731137ecb18e0fd30e8c1a0ec6a2e.png?width=2000&format=webply&optimize=medium"
        class="logo">
      <span class="header-title">SAP CDC CIAM Tester</span>
    </div>
    <nav class="nav-items">
      <a href="#" onclick="window.location.reload()">Home</a>
      <a href="#" onclick="openSettings()" class="settings-icon" title="Settings">⚙️ Settings</a>
    </nav>
  </header>

  <main class="main-container">

    <div id="welcome-section" class="welcome-block">
      <h1>Manage Your Account Anytime, Anywhere.</h1>
      <p>Select an action below to test the SAP CDC screensets.</p>
      
      <div class="action-buttons">
        <span class="notloggedin">
          <button class="btn" onclick="showLogin()">Login/Register</button> 
          <button class="btn" onclick="showIdentifierFirst()">Passwordless Login</button> 
          <button class="btn btn-primary" onclick="Orgregistration()">Register B2B Organization</button> 
        </span>
        <span class="loggedin">
          <button class="btn" onclick="profileupdate()">Update Profile</button>
          <button class="btn btn-secondary" onclick="logout()">Logout</button>
        </span>
      </div>
    </div>
    
    <div id="gigya-form-container" class="form-container">
      <button class="close-form-btn" onclick="closeForm()" title="Close Form">×</button>
    </div>

    <div class="advanced-actions loggedin">
      <h3>Manual API & JWT Testing</h3>
      <div class="action-buttons-secondary">
        <button class="btn-small" onclick="getAccountInfoManual()">Get Account Info</button>
        <button class="btn-small" onclick="verifySessionManual()">Verify Session</button>

        <button class="btn-small btn-primary" onclick="getJWT()">1. Get JWT</button>
        <button class="btn-small" onclick="decodeAndDisplayJWT()">2. Decode JWT Payload</button>
      </div>
    </div>

    <div class="advanced-actions loggedin">
      <h3>B2B & SAML Actions</h3>
      <div class="action-buttons-secondary">
        <button class="btn-small" onclick="SetOrganizationContext()">Set Org Context</button>
        <button class="btn-small" onclick="openDelegatedAdmin()">Delegated Admin</button>
        <button class="btn-small" onclick="showAuthorization()">Show Auth (App1)</button>
        <button class="btn-small" onclick="showKASAuthorization()">Show Auth (KAS)</button>
        <button class="btn-small" onclick="openKAS()">Open KAS (SAML)</button>
      </div>
    </div>
    
    <div class="advanced-actions loggedin">
        <h3>OIDC Authorization Code Flow Test (For Refresh Token)</h3>
        <div class="action-buttons-secondary">
            <button class="btn btn-primary" onclick="startOidcFlow()">Start OIDC Flow (Get Auth Code)</button>
        </div>
    </div>

    <div class="response-area loggedin">
      <h3>API Response / getAccountInfo / JWT Decode</h3>
      <textarea id="apiResponse" readonly></textarea>
    </div>

  </main>
  
  <div id="settingsModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeSettings()">&times;</span>
      <h2>CDC Tester Settings</h2>
      <p>Settings are saved locally in your browser.</p>
      
      <div class="form-group">
        <label for="settingApiKey">Site API Key:</label>
        <input type="text" id="settingApiKey" placeholder="Enter your site API Key (e.g., 4_7M0...)">
      </div>
      
      <div class="form-group">
        <label for="settingDataCenter">Data Center (DC) Code:</label>
        <input type="text" id="settingDataCenter" value="us1" placeholder="e.g., us1, eu1, eu5">
      </div>
      <hr>
      <h3>OIDC Client (Chatbot Backend RP) Settings</h3>

      <div class="form-group">
        <label for="settingOidcClientId">OIDC Client ID (for Chatbot Backend):</label>
        <input type="text" id="settingOidcClientId" placeholder="Enter Client ID from CDC Console">
        <label for="settingOidcRedirectUri">OIDC Redirect URI (Must be registered in CDC Console):</label>
        <input type="text" id="settingOidcRedirectUri" value="https://elamdemo.fwh.is/sap/cdc/oidc/rp/RPIndexPage.html" placeholder="Your backend callback URL"> 
      </div>
      
      <hr>
      <h3>ScreenSet Configuration</h3>

      <div class="form-group">
        <label for="settingLoginScreenSet">Login/Register ScreenSet:</label>
        <input type="text" id="settingLoginScreenSet" value="Default-RegistrationLogin">
        <label for="settingLoginStartScreen">Login Start Screen:</label>
        <input type="text" id="settingLoginStartScreen" value="gigya-login-screen">
        <label for="settingSessionExpiration">Session Expiration (seconds):</label>
        <input type="number" id="settingSessionExpiration" value="120" placeholder="e.g., 120">
      </div>
      
      <div class="form-group">
        <label for="settingIdentifierScreenSet">Passwordless ScreenSet (Identifier-First):</label>
        <input type="text" id="settingIdentifierScreenSet" value="Default-IdentifierFirst">
        <label for="settingIdentifierStartScreen">Passwordless Start Screen:</label>
        <input type="text" id="settingIdentifierStartScreen" value="gigya-identify-screen">
      </div>
      <div class="form-group">
        <label for="settingRegScreenSet">Organization Reg ScreenSet:</label>
        <input type="text" id="settingRegScreenSet" value="Default-OrganizationRegistration">
        <label for="settingRegStartScreen">Org. Reg Start Screen:</label>
        <input type="text" id="settingRegStartScreen" placeholder="e.g., gigya-register-screen">
      </div>

      <div class="form-group">
        <label for="settingProfileScreenSet">Profile Update ScreenSet:</label>
        <input type="text" id="settingProfileScreenSet" value="Default-ProfileUpdate">
        <label for="settingProfileStartScreen">Profile Update Start Screen:</label>
        <input type="text" id="settingProfileStartScreen" value="gigya-update-profile-screen"> 
      </div>

      <button onclick="saveSettings()" class="modal-save-btn">Save and Reload SDK</button>
      <button onclick="resetSettings()" class="modal-reset-btn">Reset All Settings</button>
    </div>
  </div>
  
  <footer class="footer">
    <div class="copy">&copy; 2025 CDC Tester</div>
  </footer>
</body>
</html>